<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å³æ™‚ç‹€æ…‹ç®¡ç†</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 min-h-screen p-6">
  <div class="max-w-xl mx-auto bg-white p-6 rounded-2xl shadow-md">
    <h1 class="text-2xl font-bold mb-4">ğŸ¡ èŠ±ç”°èˆå³æ™‚ç‹€æ…‹ç®¡ç†</h1>

    <!-- ç‡Ÿæ¥­ç‹€æ…‹åˆ‡æ› -->
    <div class="flex items-center justify-between mb-6">
      <span class="text-lg font-medium">ç‡Ÿæ¥­ç‹€æ…‹ï¼š</span>
      <button id="toggleOpen" class="px-4 py-2 rounded bg-green-500 text-white">ğŸ”„ è¼‰å…¥ä¸­...</button>
    </div>

    <h2 class="text-xl font-semibold mb-2">ğŸ“¦ é¤é»è²©å”®ç‹€æ…‹</h2>
    <ul id="productList" class="space-y-2"></ul>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBmKN4doiFaXPzzu7tmgLQ9xSXGQNvLaSo",
      authDomain: "hana-order.firebaseapp.com",
      databaseURL: "https://hana-order-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "hana-order",
      storageBucket: "hana-order.appspot.com",
      messagingSenderId: "40196534715",
      appId: "1:40196534715:web:97792006a77aebadd6549e"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const productNames = [
      "ç¶“å…¸è›‹ç‡’",
      "èµ·å¸è›‹ç‡’",
      "é›™é‡èµ·å¸",
      "æ¿ƒéƒå¡å£«é”",
      "æ³•å¼å¥¶é…¥",
      "èµ·å¸å¥¶é…¥",
      "é»‘ç³–éº»ç³¬",
      "æ—¥å¼ç´…è±†æ³¥",
      "æ—¥å¼ç´…è±†éº»ç³¬",
      "å¤æ—©å‘³é›è›‹ç³•(åŸå‘³)"
    ];

    const productList = document.getElementById("productList");
    const toggleOpen = document.getElementById("toggleOpen");

    // åˆå§‹åŒ–ç‹€æ…‹
    let open = true;
    const soldout = {};

    function renderStatus() {
      toggleOpen.textContent = open ? "ğŸŸ¢ ç‡Ÿæ¥­ä¸­ï¼ˆé»æ“Šåˆ‡æ›ï¼‰" : "ğŸ”´ ä»Šæ—¥ä¼‘æ¯ï¼ˆé»æ“Šåˆ‡æ›ï¼‰";
      toggleOpen.className = open ? "px-4 py-2 rounded bg-green-500 text-white" : "px-4 py-2 rounded bg-red-500 text-white";
    }

    function renderProducts() {
      productList.innerHTML = "";
      productNames.forEach(name => {
        const isSoldOut = soldout[name];
        const li = document.createElement("li");
        li.className = "flex justify-between items-center bg-gray-100 px-4 py-2 rounded";
        li.innerHTML = `
          <span>${name}</span>
          <button class="px-3 py-1 text-white rounded ${isSoldOut ? 'bg-red-500' : 'bg-green-500'}" data-name="${name}">
            ${isSoldOut ? 'âŒ å”®å®Œ' : 'âœ… è²©å”®ä¸­'}
          </button>
        `;
        productList.appendChild(li);
      });
    }

    // è®€å–ç‹€æ…‹
    db.ref("status/open").on("value", snapshot => {
      open = snapshot.val();
      renderStatus();
    });

    db.ref("soldout").on("value", snapshot => {
      const data = snapshot.val() || {};
      productNames.forEach(name => soldout[name] = !!data[name]);
      renderProducts();
    });

    // é»æ“Šåˆ‡æ›ç‡Ÿæ¥­
    toggleOpen.addEventListener("click", () => {
      db.ref("status/open").set(!open);
    });

    // é»æ“Šå”®å®Œ / è²©å”®ä¸­
    productList.addEventListener("click", (e) => {
      const btn = e.target.closest("button[data-name]");
      if (btn) {
        const name = btn.dataset.name;
        const current = soldout[name];
        db.ref("soldout/" + name).set(!current);
      }
    });
  </script>
</body>
</html>
