<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>èŠ±ç”°èˆ é»å–®çµå¸³ç³»çµ±</title>
  <!-- è¼‰å…¥ Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- è¼‰å…¥ React èˆ‡ ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <!-- è¼‰å…¥ Babel ç”¨ä¾†è½‰è­¯ JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-50">
  <div id="root"></div>
  <script type="text/babel">
    // ç°¡æ˜“å°è£å¸¸ç”¨å…ƒä»¶ï¼šCardã€CardContentã€Buttonã€Input
    const Card = ({ children, className = "" }) => (
      <div className={`border rounded shadow-sm p-2 ${className}`}>
        {children}
      </div>
    );

    const CardContent = ({ children, className = "" }) => (
      <div className={className}>
        {children}
      </div>
    );

    const Button = ({ children, onClick, variant, size, className = "", ...rest }) => {
      let baseClass = "px-3 py-1 rounded cursor-pointer inline-block";
      if (variant === "outline") {
        baseClass += " border";
      } else if (variant === "destructive") {
        baseClass += " bg-red-500 text-white";
      } else {
        baseClass += " bg-blue-500 text-white";
      }
      if (size === "sm") {
        baseClass += " text-sm";
      }
      return (
        <button onClick={onClick} className={`${baseClass} ${className}`} {...rest}>
          {children}
        </button>
      );
    };

    const Input = (props) => (
      <input className="border rounded px-2 py-1" {...props} />
    );

    // èœå–®å“é …è³‡æ–™
    const menu = [
      

      { name: "ç¶“å…¸è›‹ç‡’", price: 33, cost: 6.5, short: "è›‹" },
      { name: "èµ·å¸è›‹ç‡’", price: 40, cost: 12.8, short: "èµ·" },
      { name: "é›™é‡èµ·å¸", price: 30, cost: 9.25, short: "é›™" },
      { name: "æ¿ƒéƒå¡å£«é”", price: 25, cost: 7.63, short: "å¡" },
      { name: "æ³•å¼å¥¶é…¥", price: 35, cost: 10.25, short: "å¥¶" },
      { name: "èµ·å¸å¥¶é…¥", price: 35, cost: 9.12, short: "é…¥" },
      { name: "é»‘ç³–éº»ç³¬", price: 33, cost: 9.82, short: "é»‘" },
      { name: "æ—¥å¼ç´…è±†æ³¥", price: 30, cost: 6.03, short: "ç´…" },
      { name: "æ—¥å¼ç´…è±†éº»ç³¬", price: 35, cost: 8.22, short: "ç³¬" },
      { name: "å¤æ—©å‘³é›è›‹ç³•", price: 18, cost: 3, short: "å¤" },
      { name: "æ¿ƒæƒ…å·§å…‹åŠ›", price: 38, cost: 3, short: "å·§" },

      { name: "é›ªå¡©é¦™æª¸å¥¶é…¥ ", price: 40, cost: 3, short: "é›ª" },
      //{ name: "ç´«ç³¯ç±³èŠ‹æ³¥æ¹¯åœ“ ", price: 33, cost: 3, short: "ç´«" },
      //{ name: "çˆ†æ¼¿èŠ±ç”Ÿæ¹¯åœ“ ", price: 30, cost: 3, short: "èŠ±" },
      //{ name: "çˆ†æ¼¿èŠéº»æ¹¯åœ“ ", price: 30, cost: 3, short: "èŠ" },
      //{ name: "é›ªå¡©é¦™è‰å¡å£«é”", price: 30, cost: 3, short: "é›ª" },
      //{ name: "ğŸ’œ è—è“å¡å£«é”", price: 35, cost: 3, short: "è—" },
      //{ name: "ğŸ˜ˆ è—è“å¡å£«é” OREO", price: 40, cost: 3, short: "æ­" },
      //{ name: "é¦™ç”œç´«è–¯", price: 40, cost: 3, short: "ç´«" },
      //{ name: "ç´«è–¯Qéº»ç³¬", price: 45, cost: 3, short: "Q" },
      //{ name: "ç´«è–¯èµ·å¸", price: 45, cost: 3, short: "å¸" },
      //{ name: "è‰è“å¥¶é…¥", price: 40, cost: 3, short: "è“" },
      //{ name: "éµè§€éŸ³å¡å£«é”", price: 30, cost: 3, short: "éµ" },
      //{ name: "èŠ’æœå¡å£«é”", price: 33, cost: 3, short: "èŠ’" },
      //{ name: "èœœç´…èŒ¶é›è›‹ç³•", price: 30, cost: 3, short: "èœœ" },
      //{ name: "é¦™è‰å¡å£«é”", price: 30, cost: 3, short: "é¦™" },
      //{ name: "é»‘ç³–å¡å£«é”", price: 28, cost: 3, short: "é»‘å¡" },
     // { name: "é¦™è•‰å·§å…‹åŠ›", price: 40, cost: 3, short: "è•‰" },
      //{ name: "èŠ±ç”Ÿå·§å…‹åŠ›", price: 38, cost: 3, short: "èŠ±" },
      //{ name: "éµè§€éŸ³å¥¶é…¥", price: 38, cost: 3, short: "éµ" },
      //{ name: "çç éµè§€éŸ³å¥¶é…¥", price: 40, cost: 3, short: "ç" },
      //{ name: "æ´»å‹•å¡å£«é”", price: 0, cost: 3, short: "å¡" },
      //{ name: "æ´»å‹•å¤æ—©å‘³", price: 0, cost: 3, short: "å¤" },
      //{ name: "å·§å…‹åŠ›çˆ†æ¼¿éº»ç³¬", price: 43, cost: 3, short: "å·§ç³¬" },
      //{ name: "é¹¹é¦™èŠ±ç”Ÿ", price: 33, cost: 3, short: "é¹¹" },
      //{ name: "èŠ±ç”Ÿå¡å£«é”", price: 40, cost: 3, short: "èŠ±" },
      //{ name: "åˆæˆ€è‰è“å¡å£«é”", price: 33, cost: 3, short: "è“" },
      //{ name: "è‰è“Oreo", price: 38, cost: 3, short: "O" },
      //{ name: "ç‰ç±³èµ·å¸", price: 35, cost: 3, short: "ç‰èµ·" },
      //{ name: "ç‰ç±³è›‹", price: 38, cost: 3, short: "ç‰è›‹" },
      //{ name: "é®®æª¸æª¬å¥¶é…¥", price: 38, cost: 3, short: "æª¸" },
      //{ name: "èœ‚èœœé›è›‹ç³•", price: 28, cost: 3, short: "èœ‚" },
      //{ name: "èœ‚èœœå¡å£«é”", price: 30, cost: 3, short: "èœœ" },
      { name: "ç’°ä¿æè¢‹", price: 2, cost: 2, short: "æ" },
    
    ];

    // è¨‚å–®ç‹€æ…‹èˆ‡æ¨™ç±¤
    const STATUS_OPTIONS = ["queue", "cooking", "ready", "done"];
    const STATUS_LABELS = {
      queue: "ğŸ§¾ æ’éšŠä¸­",
      cooking: "ğŸ³ è£½ä½œä¸­",
      ready: "ğŸ“¦ ç­‰å¾…å–é¤",
      done: "âœ… å·²å–é¤",
    };

    function OrderSystem() {
      const { useState, useEffect } = React;
      // ç‹€æ…‹å®£å‘Š
      const [orderId, setOrderId] = useState(1);
      const [order, setOrder] = useState({});
      const [payment, setPayment] = useState(0);
      const [pickupTime, setPickupTime] = useState("");
      const [orderHistory, setOrderHistory] = useState([]);
      // é è¨­ç‹€æ…‹ç‚ºã€Œåˆ—è¡¨ã€æ¨¡å¼ï¼Œå¯å¾æ­¤ç•«é¢æ–°å¢è¨‚å–®
      const [viewingOrderId, setViewingOrderId] = useState("list");
      const [showDone, setShowDone] = useState(false);
      const [viewingMonthly, setViewingMonthly] = useState(false);"list"
      const [selectedDate, setSelectedDate] = useState(null);
      const [note, setNote] = useState("");
      const [showStats, setShowStats] = useState(false); // æ§åˆ¶éŠ·é‡å€å¡Šæ˜¯å¦å±•é–‹

      // å–å¾—ä»Šå¤©çš„æ—¥æœŸå­—ä¸²ä½œç‚º key (æ ¼å¼å¦‚ 2025-04-10)
      const getTodayKey = () => {
        return new Date().toLocaleDateString("zh-TW", {
          year: "numeric",
          month: "2-digit",
          day: "2-digit"
        }).replaceAll("/", "-");
      };

      // ç•¶ selectedDate æ”¹è®Šæ™‚ï¼Œå¾ localStorage è®€å–è©²æ—¥æœŸçš„è¨‚å–®
      useEffect(() => {
        if (selectedDate) {
          const data = JSON.parse(localStorage.getItem("orderData") || "{}");
          setOrderHistory(data[selectedDate] || []);
        }
      }, [selectedDate]);

      // å„²å­˜è¨‚å–®è³‡æ–™åˆ° localStorage
      const handleSaveOrder = () => {
        if (Object.keys(order).length === 0) {
          alert("ç›®å‰å°šæœªé¸æ“‡ä»»ä½•å“é …ï¼Œç„¡æ³•å„²å­˜è¨‚å–®ï¼");
          return;
        }
        const total = Object.entries(order).reduce((sum, [name, qty]) => {
          const item = menu.find((m) => m.name === name);
          return sum + qty * item.price;
        }, 0);

        setOrderHistory((prev) => {
          const updated = [...prev];
          const index = updated.findIndex((o) => o.orderId === orderId);
          const paid = payment >= total;
          const oldStatus = index !== -1 ? updated[index].status : "queue";
          const record = {
            orderId,
            order,
            payment,
            pickupTime,
            total,
            paid,
            status: oldStatus,
            note,
          };
          if (index !== -1) {
            updated[index] = record;
          } else {
            updated.push(record);
          }

          // å°‡è³‡æ–™å­˜å…¥ localStorage
          const today = getTodayKey();
          const monthly = JSON.parse(localStorage.getItem("orderData") || "{}");
          monthly[today] = updated;
          localStorage.setItem("orderData", JSON.stringify(monthly));

          return updated;
        });
        // å„²å­˜å¾Œå›åˆ°åˆ—è¡¨ç•«é¢
        setViewingOrderId("list");
      };

      // é€²å…¥ç·¨è¼¯æŸç­†è¨‚å–®
      const handleViewOrder = (id) => {
        const found = orderHistory.find((o) => o.orderId === id);
        if (found) {
          setOrderId(found.orderId);
          setOrder(found.order);
          setPayment(found.payment);
          setPickupTime(found.pickupTime || "");
          setViewingOrderId(null); // ç·¨è¼¯æ¨¡å¼ç‚º null
          setNote(found.note || "");
        }
      };

      // åˆªé™¤è¨‚å–®
      const handleCancelOrder = (id) => {
        const today = selectedDate || getTodayKey();
        const monthly = JSON.parse(localStorage.getItem("orderData") || "{}");
        const updated = (monthly[today] || []).filter((o) => o.orderId !== id);
        monthly[today] = updated;
        localStorage.setItem("orderData", JSON.stringify(monthly));
        setOrderHistory(updated);
      };

      // åˆ‡æ›åˆ°é¸å–æ—¥æœŸçš„è¨‚å–®ç´€éŒ„ç•«é¢
      const handleSelectDate = (date) => {
        setSelectedDate(date);
        setViewingMonthly(false);
        setViewingOrderId("list");
      };

      // æ¸²æŸ“æœ¬æœˆç‡Ÿæ¥­ç´€éŒ„
      const renderMonthlyList = () => {
        const data = JSON.parse(localStorage.getItem("orderData") || "{}");
        const dates = Object.keys(data);
        const getDailyTotal = (orders) => orders.reduce((sum, o) => sum + (o.total || 0), 0);

        return (
          <div className="p-4 bg-white rounded-xl border space-y-2">
            <h2 className="text-lg font-semibold">ğŸ“… æœ¬æœˆç‡Ÿæ¥­ç´€éŒ„</h2>
            {dates.length === 0 && <p className="text-sm text-gray-500">å°šç„¡è³‡æ–™</p>}
            <ul className="space-y-1">
              {dates.map((date) => (
                <li key={date} className="flex justify-between items-center border p-2 rounded">
                  <span>{date}ï½œğŸ’°${getDailyTotal(data[date])}</span>
                  <div className="space-x-2">
                    <Button size="sm" onClick={() => handleSelectDate(date)}>æŸ¥çœ‹</Button>
                    <select
                      className="border rounded px-2 py-1 text-sm"
                      onChange={(e) => {
                        const format = e.target.value;
                        if (!format) return;

                        const orders = data[date];
                        if (!orders || orders.length === 0) {
                          alert("é€™å¤©æ²’æœ‰è¨‚å–®ï¼Œç„¡æ³•åŒ¯å‡ºï¼");
                          return;
                        }

                        if (format === "json") {
                          const json = JSON.stringify(orders, null, 2);
                          const blob = new Blob([json], { type: "application/json" });
                          const url = URL.createObjectURL(blob);
                          const a = document.createElement("a");
                          a.href = url;
                          a.download = `${date}-orders.json`;
                          document.body.appendChild(a);
                          a.click();
                          document.body.removeChild(a);
                          URL.revokeObjectURL(url);
                        } else if (format === "csv") {
                          const header = ["è¨‚å–®ç·¨è™Ÿ", "ç¸½é‡‘é¡", "æ˜¯å¦ä»˜æ¬¾", "å–é¤æ™‚é–“", "å‚™è¨»", ...menu.map((m) => m.name)];
                          const rows = orders.map((o) => {
                            const items = menu.map((m) => o.order[m.name] || 0);
                            return [
                              o.orderId,
                              o.total,
                              o.paid ? "æ˜¯" : "å¦",
                              o.pickupTime || "",
                              `"${(o.note || "").replaceAll('"', '""')}"`,
                              ...items,
                            ];
                          });
                          const csvContent = [header, ...rows].map(r => r.join(",")).join("\n");
                          const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
                          const url = URL.createObjectURL(blob);
                          const a = document.createElement("a");
                          a.href = url;
                          a.download = `${date}-orders.csv`;
                          document.body.appendChild(a);
                          a.click();
                          document.body.removeChild(a);
                          URL.revokeObjectURL(url);
                        }

                        e.target.value = ""; // reset é¸å–®
                      }}
                    >
                      <option value="">ğŸ“¤ åŒ¯å‡º</option>
                      <option value="json">JSONï¼ˆå‚™ä»½ï¼‰</option>
                      <option value="csv">CSVï¼ˆå°å¸³ï¼‰</option>
                    </select>

                    <Button
                      size="sm"
                      variant="destructive"
                      onClick={() => {
                        const confirmed = window.confirm(`ç¢ºå®šè¦åˆªé™¤ ${date} çš„æ‰€æœ‰è¨‚å–®å—ï¼Ÿ`);
                        if (!confirmed) return;
                        const monthly = JSON.parse(localStorage.getItem("orderData") || "{}");
                        delete monthly[date];
                        localStorage.setItem("orderData", JSON.stringify(monthly));
                        setSelectedDate(null);
                        setOrderHistory([]);
                        setViewingMonthly(false);
                      }}
                    >
                      åˆªé™¤
                    </Button>
                  </div>
                </li>
              ))}
            </ul>

            {/* åŠ å…¥æœ¬æœˆçµ±è¨ˆå€å¡Š */}
            {(() => {
              const dailyTotals = dates.map((date) => getDailyTotal(data[date]));
              const totalRevenue = dailyTotals.reduce((sum, v) => sum + v, 0);
              const averageRevenue = dailyTotals.length > 0 ? (totalRevenue / dailyTotals.length).toFixed(2) : 0;
              return (
                <p className="text-sm font-semibold mt-4">
                  ğŸ’° æœ¬æœˆç‡Ÿæ¥­ç¸½é¡ï¼š${totalRevenue}ï½œğŸ“Š å¹³å‡æ¯æ—¥ç‡Ÿæ¥­é¡ï¼š${averageRevenue}
                </p>
              );
            })()}


            <Button variant="outline" className="mt-2" onClick={() => setViewingMonthly(false)}>ğŸ”™ è¿”å›</Button>
          </div>
        );
      };

      // æ¸²æŸ“ç•¶æ—¥é»å–®åˆ—è¡¨ç•«é¢ï¼Œä¸¦åŠ å…¥ã€Œæ–°å¢è¨‚å–®ã€æŒ‰éˆ•ï¼›åŒæ™‚å°å·²å–é¤ (done) ç‹€æ…‹å¯¦ä½œæŠ˜ç–Š/å±•é–‹åŠŸèƒ½
      const renderOrderList = () => {
        const totalStats = {};
        let totalRevenue = 0;
        orderHistory.forEach((o) => {
          totalRevenue += o.total || 0;
          Object.entries(o.order).forEach(([name, qty]) => {
            totalStats[name] = (totalStats[name] || 0) + qty;
          });
        });
        const totalQty = Object.values(totalStats).reduce((a, b) => a + b, 0);

        return (
          <div className="p-4 bg-white rounded-xl border space-y-2 relative pb-20">
            <h2 className="text-lg font-semibold">
              ğŸ“‹ ç•¶æ—¥é»å–®è¨˜éŒ„ï¼ˆ{selectedDate || getTodayKey()}ï¼‰
            </h2>
            {STATUS_OPTIONS.map((status) => {
              // é‡å°æ¯ä¸€å€‹ç‹€æ…‹éæ¿¾ç›¸å°æ‡‰çš„è¨‚å–®è³‡æ–™
              const filtered = orderHistory
                .filter((o) => o.status === status)
                .slice()
                .reverse();

              // é‡å°å·²å–é¤ç‹€æ…‹ (done) é€²è¡ŒæŠ˜ç–Š/å±•é–‹æ§åˆ¶
              if (status === "done") {
                return (
                  <div key={status} className="mt-4">
                    <h3
                      className="font-semibold bg-green-100 px-2 py-1 rounded cursor-pointer inline-block"
                      onClick={() => setShowDone(!showDone)}
                    >
                      {showDone ? "ğŸ”½" : "â–¶ï¸"} {STATUS_LABELS[status]} ({filtered.length})
                    </h3>
                    {showDone && (
                      <div className="rounded-lg p-3 space-y-2 bg-green-100 mt-2">
                        {filtered.map((orderObj) => {
                          const shortCount = {};
                          menu.forEach((item) => {
                            const qty = orderObj.order[item.name] || 0;
                            if (qty > 0) {
                              shortCount[item.short] = (shortCount[item.short] || 0) + qty;
                            }
                          });
                          const shortList = Object.entries(shortCount)
                            .map(([short, qty]) => `${short}${qty > 1 ? "*" + qty : ""}`)
                            .join("ã€");

                          return (
                            <div key={orderObj.orderId} className="bg-white rounded-xl border shadow-sm p-3">
                              <div className="flex justify-between items-center">
                                <span>
                                  #{orderObj.orderId}ï½œ${orderObj.total}ï½œ{orderObj.paid ? "âœ… å·²æ”¶æ¬¾" : "âŒ› æœªæ”¶æ¬¾"}ï½œå–é¤æ™‚é–“ï¼š
                                  {orderObj.pickupTime || "-"}
                                </span>
                                <div className="space-x-2 flex items-center">
                                  <select
                                    value={orderObj.status}
                                    onChange={(e) => {
                                      const newStatus = e.target.value;
                                      const updatedHistory = orderHistory.map((o) =>
                                        o.orderId === orderObj.orderId ? { ...o, status: newStatus } : o
                                      );
                                      setOrderHistory(updatedHistory);
                                      const today = selectedDate || getTodayKey();
                                      const monthly = JSON.parse(localStorage.getItem("orderData") || "{}");
                                      monthly[today] = updatedHistory;
                                      localStorage.setItem("orderData", JSON.stringify(monthly));
                                    }}
                                    className="border rounded px-1 text-sm"
                                  >
                                    {STATUS_OPTIONS.map((s) => (
                                      <option key={s} value={s}>
                                        {STATUS_LABELS[s]}
                                      </option>
                                    ))}
                                  </select>
                                  <Button size="sm" onClick={() => handleViewOrder(orderObj.orderId)}>
                                    æŸ¥çœ‹
                                  </Button>
                                  <Button size="sm" variant="destructive" onClick={() => handleCancelOrder(orderObj.orderId)}>
                                    å–æ¶ˆ
                                  </Button>
                                </div>
                              </div>
                              <div className="text-sm text-gray-600 mt-1 break-all">
                                {shortList}
                              </div>
                              {orderObj.note && (
                                <div className="text-sm text-pink-600 mt-1">
                                  ğŸ“ å‚™è¨»ï¼š{orderObj.note}
                                </div>
                              )}
                            </div>
                          );
                        })}
                      </div>
                    )}
                  </div>
                );
              }

              // é‡å°å…¶ä»–ç‹€æ…‹ (queueã€cookingã€ready)
              const bgColor =
                status === "queue"
                  ? "bg-yellow-100"
                  : status === "cooking"
                  ? "bg-orange-100"
                  : status === "ready"
                  ? "bg-blue-100"
                  : "bg-green-100";
              return (
                <div key={status} className={`mt-4 rounded-lg p-3 space-y-2 ${bgColor}`}>
                  <h3 className="text-base font-bold">
                    {STATUS_LABELS[status]} ({filtered.length})
                  </h3>
                  {filtered.map((orderObj) => {
                    const shortCount = {};
                    menu.forEach((item) => {
                      const qty = orderObj.order[item.name] || 0;
                      if (qty > 0) {
                        shortCount[item.short] = (shortCount[item.short] || 0) + qty;
                      }
                    });
                    const shortList = Object.entries(shortCount)
                      .map(([short, qty]) => `${short}${qty > 1 ? "*" + qty : ""}`)
                      .join("ã€");

                    return (
                      <div key={orderObj.orderId} className="bg-white rounded-xl border shadow-sm p-3">
                        <div className="flex justify-between items-center">
                          <span>
                            #{orderObj.orderId}ï½œ${orderObj.total}ï½œ{orderObj.paid ? "âœ… å·²æ”¶æ¬¾" : "âŒ› æœªæ”¶æ¬¾"}ï½œå–é¤æ™‚é–“ï¼š
                            {orderObj.pickupTime || "-"}
                          </span>
                          <div className="space-x-2 flex items-center">
                            <select
                              value={orderObj.status}
                              onChange={(e) => {
                                const newStatus = e.target.value;
                                const updatedHistory = orderHistory.map((o) =>
                                  o.orderId === orderObj.orderId ? { ...o, status: newStatus } : o
                                );
                                setOrderHistory(updatedHistory);
                                const today = selectedDate || getTodayKey();
                                const monthly = JSON.parse(localStorage.getItem("orderData") || "{}");
                                monthly[today] = updatedHistory;
                                localStorage.setItem("orderData", JSON.stringify(monthly));
                              }}
                              className="border rounded px-1 text-sm"
                            >
                              {STATUS_OPTIONS.map((s) => (
                                <option key={s} value={s}>
                                  {STATUS_LABELS[s]}
                                </option>
                              ))}
                            </select>
                            <Button size="sm" onClick={() => handleViewOrder(orderObj.orderId)}>
                              æŸ¥çœ‹
                            </Button>
                            <Button size="sm" variant="destructive" onClick={() => handleCancelOrder(orderObj.orderId)}>
                              å–æ¶ˆ
                            </Button>
                          </div>
                        </div>
                        <div className="text-sm text-gray-600 mt-1 break-all">
                          {shortList}
                        </div>
                        {orderObj.note && (
                          <div className="text-sm text-pink-600 mt-1">
                            ğŸ“ å‚™è¨»ï¼š{orderObj.note}
                          </div>
                        )}
                      </div>
                    );
                  })}
                </div>
              );
            })}

            <div className="mt-4">
              <h3
                className="font-semibold bg-yellow-100 px-2 py-1 rounded cursor-pointer inline-block"
                onClick={() => setShowStats(!showStats)}
              >
                {showStats ? "ğŸ”½" : "â–¶ï¸"} ğŸ¡ å„å£å‘³ç¸½éŠ·é‡ï¼ˆé»æ“Šå±•é–‹ï¼‰
              </h3>

              {showStats && (
                <div className="bg-yellow-50 mt-2 rounded-lg p-3 space-y-1 text-sm">
                  <ul className="space-y-1">
                    {menu.map((item) => (
                      <li key={item.name}>
                        {item.name}ï¼š{totalStats[item.name] || 0} é¡†
                      </li>
                    ))}
                  </ul>
                  <p className="mt-2 font-semibold">
                    ğŸ¡ ç¸½è¨ˆï¼š{totalQty} é¡†
                  </p>
                  <p className="mt-1 font-semibold">ğŸ’° ç‡Ÿæ¥­é¡ï¼š${totalRevenue}</p>
                </div>
              )}
            </div>

            
            {/* åœ¨åˆ—è¡¨ç•«é¢ä¸‹æ–¹åŠ å…¥ã€Œæ–°å¢è¨‚å–®ã€æŒ‰éˆ• */}
            <div className="flex space-x-2 mt-2">
              <Button variant="outline" onClick={() => setViewingMonthly(true)}>
                ğŸ“… æŸ¥çœ‹æœ¬æœˆç‡Ÿæ¥­ç´€éŒ„
              </Button>
              <Button
                onClick={() => {
                  const nextId = orderHistory.length > 0
                    ? Math.max(...orderHistory.map((o) => o.orderId)) + 1
                    : 1;
                  setOrderId(nextId);
                  setOrder({});
                  setPayment(0);
                  setPickupTime("");
                  setNote("");
                  setViewingOrderId(null); // åˆ‡æ›è‡³ç·¨è¼¯æ¨¡å¼
                }}
              >
                â• æ–°å¢è¨‚å–®
              </Button>

              <Button
                    variant="outline"
                    onClick={() => window.location.href = 'realtime.html'}
                >
                    ğŸŸ¢ å³æ™‚ç‹€æ…‹
                </Button>

            </div>
          </div>
        );
      };

      // ä¸»æ¸²æŸ“æµç¨‹ï¼Œæ ¹æ“š viewingOrderId æ±ºå®šé¡¯ç¤ºåˆ—è¡¨æˆ–ç·¨è¼¯ç•«é¢
      return (
        <div className="min-h-screen flex justify-center pt-16 px-4">
          <div className="w-full max-w-3xl mx-auto space-y-4">
            <h1 className="text-xl font-bold">ğŸŒ¸ èŠ±ç”°èˆ é»å–®çµå¸³ç³»çµ±</h1>
            {viewingMonthly
              ? renderMonthlyList()
              : viewingOrderId === "list"
              ? renderOrderList()
              : (
                <>
                  <p className="text-sm">é»å–®ç·¨è™Ÿï¼š#{orderId}</p>
                  {menu.map((item) => (
                    <Card key={item.name} className="flex items-center justify-between p-2">
                      <CardContent className="flex flex-col w-full">
                        <div className="flex justify-between items-center w-full">
                          <span className="text-base">{item.name} - ${item.price}</span>
                          <div className="flex items-center space-x-2">
                            <Button
                              onClick={() =>
                                setOrder((prev) => ({
                                  ...prev,
                                  [item.name]: Math.max((prev[item.name] || 0) - 1, 0),
                                }))
                              }
                            >
                              -
                            </Button>

                            <input
                              type="number"
                              value={order[item.name] || 0}
                              min="0"
                              className="w-16 text-center border rounded px-1 py-0.5"
                              onChange={(e) => {
                                const value = Math.max(0, parseInt(e.target.value) || 0);
                                setOrder((prev) => ({
                                  ...prev,
                                  [item.name]: value,
                                }));
                              }}
                            />

                            <Button
                              onClick={() =>
                                setOrder((prev) => ({
                                  ...prev,
                                  [item.name]: (prev[item.name] || 0) + 1,
                                }))
                              }
                            >
                              +
                            </Button>
                          </div>

                        </div>
                      </CardContent>
                    </Card>
                  ))}
                  
                  <div className="p-4 bg-gray-100 rounded-xl space-y-2">

                    <p className="text-lg font-bold text-pink-700 bg-pink-100 px-3 py-2 rounded shadow-sm break-all">
                      ğŸ“ çƒ˜è£½é †åºï¼š
                      {menu
                        .filter(item => item.name !== "ç’°ä¿æè¢‹") // â›” éæ¿¾æ‰æè¢‹
                        .map((item) => {
                          const qty = order[item.name] || 0;
                          return qty > 0 ? `${item.short}x${qty}` : null;
                        })
                        .filter(Boolean)
                        .join("ã€")}
                    </p>





                    <p>
                      ğŸ§¾ ç¸½é‡‘é¡ï¼š${Object.entries(order).reduce((sum, [name, qty]) => {
                        const item = menu.find((m) => m.name === name);
                        return sum + qty * item.price;
                      }, 0)}
                    </p>
                    <p>ğŸ“¦ ç¸½æ•¸é‡ï¼š{Object.entries(order).reduce((sum, [name, qty]) => {
                      if (name === "ç’°ä¿æè¢‹") return sum; // ä¸è¨ˆå…¥
                      return sum + qty;
                    }, 0)} é¡†</p>

                    <div className="flex items-center space-x-2">
                      <label>æ”¶æ¬¾é‡‘é¡ï¼š</label>
                      <Input
                        type="number"
                        value={payment}
                        onChange={(e) => setPayment(Number(e.target.value))}
                        className="w-24"
                      />
                    </div>
                    <div className="flex items-center space-x-2">
                      <label>å–é¤æ™‚é–“ï¼š</label>
                      <Input
                        type="text"
                        value={pickupTime}
                        onChange={(e) => setPickupTime(e.target.value)}
                        placeholder="ä¾‹ï¼š17:30"
                        className="w-32"
                      />
                    </div>
                    <div className="flex flex-col mt-2">
                      <label className="text-sm font-medium mb-1">å‚™è¨»ï¼š</label>
                      <textarea
                        className="border rounded p-2 text-sm"
                        rows={2}
                        value={note}
                        onChange={(e) => setNote(e.target.value)}
                        placeholder="ä¾‹ï¼šä¸è¦èµ·å¸ã€5é»åŠå†æ‹¿"
                      />
                    </div>
                    <p>
                      ğŸ’µ æ‰¾é›¶é‡‘é¡ï¼š${
                        (payment - Object.entries(order).reduce((sum, [name, qty]) => {
                          const item = menu.find((m) => m.name === name);
                          return sum + qty * item.price;
                        }, 0)) >= 0
                          ? (payment - Object.entries(order).reduce((sum, [name, qty]) => {
                              const item = menu.find((m) => m.name === name);
                              return sum + qty * item.price;
                            }, 0)).toFixed(0)
                          : "é‡‘é¡ä¸è¶³"
                    }
                    </p>
                    <div className="flex space-x-2">
                      <Button onClick={handleSaveOrder}>ğŸ’¾ å„²å­˜è¨‚å–®</Button>
                      <Button
                        onClick={() => {
                          const nextId = orderHistory.length > 0
                            ? Math.max(...orderHistory.map((o) => o.orderId)) + 1
                            : 1;
                          setOrderId(nextId);
                          setOrder({});
                          setPayment(0);
                          setPickupTime("");
                          setNote("");
                        }}
                      >
                        â• æ–°å¢ä¸‹ä¸€ç­†
                      </Button>
                      <Button onClick={() => setViewingOrderId("list")} variant="outline">
                        ğŸ“‹ æŸ¥çœ‹æ‰€æœ‰é»å–®
                      </Button>
                    </div>
                  </div>
                </>
              )
            }
          </div>
        </div>
      );
    }

    // å°‡ OrderSystem æ¸²æŸ“åˆ° #root å…ƒç´ 
    ReactDOM.render(<OrderSystem />, document.getElementById("root"));
  </script>
</body>
</html>
